# 奇妙数值

## 处理计数

### 二值化

### 区间量化（分箱）

将数据分到多个箱子里去，去掉实际的计数值。区间量化可以将连续型数值映射为离散型数值。将离散型数值看作一种有序的分箱序列，表示的对密度的测量。

#### 固定宽度分箱

一个具体数值

如果跨越多个数量级，最好按照10的幂（或任何常数的幂）对数

#### 分位数分箱

分位数是可以将数据划分为相等的若干份数的值

```
>>> import pandas as pd
>>> pd.qcut(large_counts, 4, labels=False) 
array([1, 3, 3, 0, 0, 1, 2, 2], dtype=int64)
>>> large_counts_series = pd.Series(large_counts)
>>> large_counts_series.quantile([0.25,0.5,0.75])
0.25     242.0
0.50     796.0
0.75    3732.0
dtype: float64
```

`qcut` 根据这些值的频率选择箱子的均匀间隔，即每一个箱子中含有的数数量相同

`quantile` 计算分位数

## 对数变换 

对数函数可以对大数值的范围进行压缩，对小数值的范围进行扩展。x 越大，log(x) 增长越慢

对于 `重尾分布` 的正数值的处理，使用对数变换。压缩分布高端的长尾，使之成为较短的尾部，将低端扩展为更长的头部。

### 重尾分布

自然界中，少量个体做出大量贡献，直观特点：大头短，小尾长

### 指数变换

指数变换是一个变换族，都是方差稳变化变换。

数据分布可能不服从我们熟悉的钟形曲线(又名正态分布)。结果得到的分布是不对称的右侧长尾分布。这种现象被称为“异方差性”(不恒定方差)。如果您正在进行回归分析或实验设计(任何统计模型)，这种不对称分布可能会导致模型扭曲。

解决重尾分布的一个方法就是使用`Box-Cox` 将数据转换为正态。
$$
\tilde x = \left\{ {\begin{array}{*{20}{c}}
{\frac{{{x^\lambda } - 1}}{\lambda }}\\
{\ln (x)}
\end{array}} \right.
$$
只有当数据为正时，Box-Cox公式才有效。对于非正数据，我们可以加上一个固定的常数，对数据进行平移。